---
phase: 04-ios-liquid-glass-ui
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified: [views/css/style.css]
autonomous: false
---

<objective>
Complete glass UI with headers/bars treatment, refined depth system, and performance optimization.

Purpose: Finish the iOS liquid glass aesthetic across all UI elements and ensure smooth 60fps performance.
Output: Fully polished glass UI with optimized animations and verified visual quality.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-ios-liquid-glass-ui/04-01-SUMMARY.md

@views/css/style.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Apply glass to headers and bars</name>
  <files>views/css/style.css</files>
  <action>
Update header and bar elements to use glass effects:

1. **.terminal-bar** (~line 579): Apply glass treatment
   - Replace `background: var(--card-bg);` with `background: var(--glass-bg);`
   - Add `backdrop-filter: blur(var(--glass-blur));`
   - Add `-webkit-backdrop-filter: blur(var(--glass-blur));`
   - Replace border with `border-bottom: 1px solid var(--glass-border-light);`

2. **.gsd-command-bar** (~line 748): Apply glass treatment
   - Replace `background: rgba(28, 28, 30, 0.8);` with `background: var(--glass-bg-light);`
   - Add `backdrop-filter: blur(var(--glass-blur-light));`
   - Add `-webkit-backdrop-filter: blur(var(--glass-blur-light));`
   - Update border to use `border-bottom: 1px solid var(--glass-border-light);`

3. **.btn-icon** (~line 588): Subtle glass on icon buttons
   - Replace `background: rgba(255, 255, 255, 0.08);` with `background: var(--glass-highlight);`
   - Add `backdrop-filter: blur(4px);`
   - Add `-webkit-backdrop-filter: blur(4px);`

4. **.gsd-cmd-btn** (~line 757): Glass treatment for command buttons
   - Replace `background: rgba(255, 255, 255, 0.06);` with `background: var(--glass-highlight);`
   - Add subtle backdrop-filter: `backdrop-filter: blur(4px);`
   - Add `-webkit-backdrop-filter: blur(4px);`

5. **.add-btn** (~line 446): Glass treatment for add button
   - Replace `background: var(--card-bg);` with `background: var(--glass-bg);`
   - Add `backdrop-filter: blur(var(--glass-blur-light));`
   - Add `-webkit-backdrop-filter: blur(var(--glass-blur-light));`
   - Update border to `border: 1px solid var(--glass-border);`

IMPORTANT: Include both backdrop-filter AND -webkit-backdrop-filter for all elements.
  </action>
  <verify>grep -c "backdrop-filter" views/css/style.css shows multiple occurrences (should be 10+)</verify>
  <done>Terminal bar, command bar, and buttons all have consistent glass treatment</done>
</task>

<task type="auto">
  <name>Task 2: Refined depth system and performance optimization</name>
  <files>views/css/style.css</files>
  <action>
1. **Add depth layer tokens** to :root (after glass tokens):
```css
/* Depth Layers */
--depth-1: 0 2px 8px rgba(0, 0, 0, 0.2);
--depth-2: 0 4px 16px rgba(0, 0, 0, 0.25);
--depth-3: 0 8px 32px rgba(0, 0, 0, 0.3);
--depth-elevated: 0 12px 40px rgba(0, 0, 0, 0.4);
```

2. **Update container shadow** (~line 83):
   - Replace existing box-shadow with:
   ```css
   box-shadow:
       0 0 0 0.5px var(--glass-border),
       var(--depth-elevated);
   ```

3. **Update card shadows**:
   - .card: Use `box-shadow: inset 0 1px 0 var(--glass-highlight), var(--depth-1);`
   - .card:hover: Use `box-shadow: inset 0 1px 0 var(--glass-highlight), var(--depth-3);`

4. **Performance optimization - add will-change hints**:
   - Add to .container: `will-change: backdrop-filter;`
   - Add to .card: Ensure `will-change: transform, box-shadow, backdrop-filter;`
   - Add to .terminal-bar: `will-change: backdrop-filter;`

5. **Smooth blur transitions** - add transition for backdrop-filter:
   - On .card, add to transition: `backdrop-filter var(--duration-fast) var(--ease-out-quart)`
   - On .pinned-item, add to transition: `backdrop-filter var(--duration-fast) var(--ease-out-quart)`

6. **Reduced motion support** - update @media (prefers-reduced-motion) section (~line 1052):
   - Add: `backdrop-filter: none !important;` to the * selector to disable blur for reduced motion users

IMPORTANT: Do not add will-change to too many elements - only primary glass containers.
  </action>
  <verify>App launches without errors, scrolling and hover interactions are smooth</verify>
  <done>Depth system uses consistent tokens, performance optimized with will-change, transitions smooth</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete iOS liquid glass UI with frosted effects on all UI elements</what-built>
  <how-to-verify>
    1. Run: npm start (or however app is launched)
    2. Click tray icon to open popover
    3. Verify glass effects:
       - Container has subtle frosted appearance
       - Session cards show glass/blur effect
       - Pinned items have glass treatment
       - Terminal bar and command bar have blur
    4. Test interactions:
       - Hover over cards - smooth transition, depth increases
       - Hover over buttons - subtle glass highlight
       - Scroll content - smooth 60fps, no jank
    5. Test edge cases:
       - Open terminal view - bars should have glass
       - Toggle between views - transitions smooth
    6. Confirm overall aesthetic:
       - Does it feel like iOS liquid glass?
       - Is depth/layering visually pleasing?
       - Are blur amounts appropriate (not too heavy/light)?
  </how-to-verify>
  <resume-signal>Type "approved" to complete phase, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All headers/bars have glass treatment
- [ ] Depth tokens exist and are used consistently
- [ ] Performance optimizations in place (will-change)
- [ ] Smooth transitions on blur changes
- [ ] Reduced motion support updated
- [ ] User approved visual quality
</verification>

<success_criteria>
- All UI elements have consistent glass treatment
- Depth system provides clear visual hierarchy
- Animations run at 60fps
- Reduced motion users get non-animated fallback
- Visual quality approved by user
</success_criteria>

<output>
After completion, create `.planning/phases/04-ios-liquid-glass-ui/04-02-SUMMARY.md`
</output>
